# Сервис проведения тендеров

Сделал backend для сервиса, который позволит бизнесу создать тендер на оказание каких-либо услуг. А пользователи/другие бизнесы могут предлагать свои выгодные условия для получения данного тендера.

## Стек
* Язык - Python
* Фреимворк - Django
* БД - внешняя Postgres
* Можно запускать в виде Docker контейнера

### Краткое описание

* Эндпоинты все работают как указано в openapi.yml.
* Проект собирается в докер контейнер и слушает 8080 порт.
* Используется база, указанная в переменных окружения контейнера.
* Прооцес согласования тендера происходит согласно кворума, один сотрудник организации может проголосовать только один раз, reject  в приоритете - даже если согласно кворуму предложение принято оно отменяется и тендер возвращается в статус опуьликован.
* В планахо оптимизировать запросы к БД, добавить тесты.


## Про приложение

### Настройка приложения производится через переменные окружения

- `POSTGRES_USERNAME` — имя пользователя для подключения к PostgreSQL.
- `POSTGRES_PASSWORD` — пароль для подключения к PostgreSQL.
- `POSTGRES_HOST` — хост для подключения к PostgreSQL (например, localhost).
- `POSTGRES_PORT` — порт для подключения к PostgreSQL (например, 5432).
- `POSTGRES_DATABASE` — имя базы данных PostgreSQL, которую будет использовать приложение.

## Основные возможности

### API
Все эндпоинты начинаются с префикса /api.

Все запросы и ответы соответствуют структуре и требованиям спецификации Open API, включая статус-коды, ограничения по длине и допустимые символы в строках.

Если запрос не соответствует требованиям, возвращается статус-код 400. Если же имеется более специфичный код ответа, используется он.

Если в запросе есть хотя бы один некорректный параметр, весь запрос будет отклонён.

### Бизнес-логика
#### Тендер

Тендеры могут создавать только пользователи от имени своей организации.

Доступные действия с тендером:

- **Создание**:

  - Тендер будет создан.

  - Доступен только ответственным за организацию.

  - Статус: `CREATED`.

- **Публикация**:

  - Тендер становится доступен всем пользователям.

  - Статус: `PUBLISHED`.

- **Закрытие**:

  - Тендер больше не доступен пользователям, кроме ответственных за организацию.

  - Статус: `CLOSED`.

- **Редактирование**:

  - Изменяются характеристики тендера.

  - Увеличивается версия.

#### Предложение

Предложения могут создавать пользователи от имени своей организации.

Предложение связано только с одним тендером. Один пользователь может быть ответственным в одной организации.

Доступные действия с предложениями:

- **Создание**:

  - Предложение будет создано.

  - Доступно только автору и ответственным за организацию.

  - Статус: `CREATED`.

- **Публикация**:

  - Предложение становится доступно ответственным за организацию и автору.

  - Статус: `PUBLISHED`.

- **Отмена**:

  - Виден только автору и ответственным за организацию.

  - Статус: `CANCELED`.

- **Редактирование**:

  - Изменяются характеристики предложения.

  - Увеличивается версия.

- **Согласование/отклонение**:

  - Доступно только ответственным за организацию, связанной с тендером.

  - Решение может быть принято любым ответственным.

  - При согласовании одного предложения, тендер автоматически закрывается.

## Дополнительные возможности

1. Расширенный процесс согласования:

   - Если есть хотя бы одно решение reject, предложение отклоняется.
   
   - Для согласования предложения нужно получить решения больше или равно кворуму.
   
   - Кворум = min(3, количество ответственных за организацию).

3. Просмотр отзывов на прошлые предложения:

   - Ответственный за организацию может просмотреть отзывы на предложения автора, который создал предложение для его тендера.

5. Оставление отзывов на предложение:

   - Ответственный за организацию может оставить отзыв на предложение.

7. Добавить возможность отката по версии (Тендер и Предложение):

   - После отката, считается новой правкой с увеличением версии.


## Запуск приложения

### Вариант 1: в Docker контейнере
* Клонирование репозитория:
```
$ git clone https://github.com/SoloMen88/tenderServise
```
* Сборка контейнера
```
docker build -t tenderServise .
```
* Запуск контейнека
```
docker run --name tenderServise -it -p 8080:8080 tenderServise
```

### Вариант 2: в тестовой среде
* Клонирование репозитория:
```
$ git clone https://github.com/SoloMen88/tenderServise
```
* Создание виртуального окружения
```
python -m venv venv
```
* Запуск виртуального окружения
```
source venv/Scripts/activate
```
* Установка зависимостей
```
pip install -r requirements.txt
```
* Запустить БД Postgres
* Либо в переменных окружения ОС либо в файле .env прописать параметры доступа к БД
* Запуск скриптов миграции
```
python manage.py migrate
```
* Запуск сервера на порту 8080
```
python manage.py runserver 0:8080
```